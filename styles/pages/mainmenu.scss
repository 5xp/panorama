@use '../config' as *;
@use '../abstract/function';

$page-transition-duration: 0.15s;
$page-transition-timing-func: ease-in-out;

#TooltipManager,
#ContextMenuManager,
#PopupManager,
.MainMenuRootPanel {
	width: 100%;
	height: 100%;
}

.MainMenuRootPanel.PopupBackgroundBlur #MainMenuInput {
	blur: gaussian(8, 8, 5);
	-s2-mix-blend-mode: opaque;
}

.MainMenuModeOnly {
	visibility: visible;
}

.MainMenuRootPanel--PauseMenuMode .MainMenuModeOnly {
	visibility: collapse;
}

.PauseMenuModeOnly {
	visibility: collapse;
}

.MainMenuRootPanel--PauseMenuMode .PauseMenuModeOnly {
	visibility: visible;
}

$topnav-height: 100px;
$rightnav-width: 50px;
$drawer-width: 768px;

.mainmenu {
	width: 100%;
	height: 100%;

	&__container {
		width: 1920px;
		height: 1080px;
	}

	&__background {
		width: 100%;
		height: 100%;
	}

	&__background-blur {
		width: 100%;
		height: 100%;
		blur: fastgaussian(2, 2, 4);
	}

	&__content-blur {
		// Let this panel clip outside the page so the blur applies all the way to the edges
		// mainmenu__container will constrain all children to 1920x1080
		width: 110%;
		height: 110%;
		overflow: noclip;
		blur: fastgaussian(8, 8, 5);
	}
	
	&__pause-blur {
		width: 100%;
		height: 100%;
		blur: fastgaussian(2, 2, 3);
	}

	&__movie {
		width: 1920px;
		height: 1080px;
		overflow: noclip;

		.AspectRatio4x3,
		.AspectRatio5x4 {
			transform: translateX(-17%);
			overflow: noclip;
		}

		.AspectRatio16x10 {
			transform: translateX(-10%);
			overflow: noclip;
		}

	.AspectRatio21x9 {
			width: 2580px;
			height: 1080px;
			transform: scaleY(1.3) translateY(-15%);
			overflow: noclip;
		}
	}

	&__content {
		width: fill-parent-flow(1);
		height: fill-parent-flow(1);
		margin-top: $topnav-height;
	}

	&__home-container,
	&__page-container {
		width: 100%;
		height: 100%;
		opacity: 1;
		transition-property: opacity;
		transition-duration: $page-transition-duration;
		transition-timing-function: $page-transition-timing-func;

		&--hidden {
			opacity: 0;
		}
	}

	// BaseBlurTarget needs a translucent background to draw on/over/behind/whatever for some reason
	&__pause-content-blur {
		width: 100%;
		height: 100%;
		background-color: rgba(0, 0, 0, 0.005);
	}

	&__page-blur {
		width: 100%;
		height: 100%;
		background-color: rgba(0, 0, 0, 0.875);
	}

	&__page {
		flow-children: down;
		width: 100%;
		height: 100%;
		padding: 30px (30px + $rightnav-width) 30px 30px;
		
		transition-property: opacity;
		transition-duration: .0s;
		transition-timing-function: ease-in-out;
	}
}

.topnav {
	flow-children: right;
	height: $topnav-height;
	width: 100%;
	background-color: function.gradient-vertical(rgba(51, 51, 51, 0.3), rgba(20, 20, 20, 0.3));
	z-index: 1;

	&__home {
		height: 100%;
		background-color: rgba(255, 255, 255, 0);
		transition: background-color 0.2s ease-in-out 0s;
		transition-property: opacity, background-color;
		transition-duration: 0.2s;
		transition-timing-function: ease-in-out;

		&:hover {
			background-color: gradient(radial, 50% 100%, 0% 0%, 100% 100%, from(rgba(255, 255, 255, 0.3)), to(rgba(255, 255, 255, 0.2)));
			box-shadow: 0 0 1px 0 rgba(0, 0, 0, 0.2);
		}

		.RadioBox {
			visibility: collapse;
		}
	}

	&__logo {
		margin: 0 24px;
		vertical-align: middle;
		// img-shadow: 1px 1px 8px 1 black;
	}

	&__button {
		height: 100%;
		vertical-align: middle;
		padding: 25px;
		background-color: gradient(radial, 50% 100%, 0% 0%, 100% 100%, from(rgba(128, 128, 128, 0)), to(rgba(128, 128, 128, 0))); //
		box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);
		transition-property: background-color, box-shadow;
		transition-duration: 0.1s;
		transition-timing-function: ease-out;

		& .RadioBox {
			visibility: collapse;
		}
		
		&-image {
			width: height-percentage(100%);
			height: 100%;
			vertical-align: middle;
			color: white;
			opacity: 0.85;
			img-shadow: 0px 0px 5px 0 rgba(0, 0, 0, 0.4);
			transition-property: opacity;
			transition-duration: 0.1s;
			transition-timing-function: ease-in;
		}

		$this: &;
		&:hover {
			background-color: gradient(radial, 50% 100%, 0% 0%, 100% 100%, from(rgba(255, 255, 255, 0.25)), to(rgba(209, 209, 209, 0.25)));
			box-shadow: 0 0 1px 0 rgba(0, 0, 0, 0.35);

			#{$this}-image {
				opacity: 1;
			}
		}
		
		&:selected {
			background-color: gradient(radial, 50% 100%, 0% 0%, 100% 100%, from(rgba(88, 88, 88, 0.7)), to(rgba(20, 20, 20, 0.7)));
			box-shadow: 0 0 4px 0 rgba(0, 0, 0, 0.3);
			
			#{$this}-image {
				opacity: 1;
			}
		}
		
		&:selected:hover {
			background-color: gradient(radial, 50% 100%, 0% 0%, 100% 100%, from(rgba(70, 70, 70, 0.8)), to(rgba(20, 20, 20, 0.8)));
		}
	}
	
	&__home, &__button {
		&:hover {
			sound: "UIPanorama.ButtonRollover";
		}
		&:selected {
			sound: "UIPanorama.ButtonPress";
		}
	}

	&__shadow {
		z-index: 1;
		margin-top: $topnav-height;
		width: 100%;
		height: 24px;
		opacity: 0.8;
		background-color: gradient(linear, 0% 100%, 0% 0%, from(rgba(0, 0, 0, 0)), color-stop(0.5, rgba(0, 0, 0, 0.275)), to(rgba(0, 0, 0, 0.8)));
	}
}

.rightnav {
	width: $rightnav-width;
	height: 100%;
	flow-children: down;
	horizontal-align: right;
	background-color: rgba(0, 0, 0, 0.5);

	$root: &;
	&__button {
		width: 100%;
		height: width-percentage(100%);
		padding: 12px 12px;
		background-color: rgba(255, 255, 255, 0);
		transition: background-color 0.1s ease-in-out 0s;

		& .RadioBox {
			visibility: collapse;
		}

		&-image {
			width: 100%;
			height: width-percentage(100%);
			vertical-align: middle;
			opacity: 0.75;
			transition: opacity 0.1s ease-in-out 0s;
		}

		$button: &;
		&:hover,
		&:selected:not(#{$root}__drawerbutton) {
			background-color: rgba(255, 255, 255, 0.15);

			#{$button}-image {
				opacity: 1;
			}
		}
	}

	&__drawerbutton {
		height: 100%;
	}

	&__shadow {
		z-index: 1;
		width: 24px;
		height: 100%;
		border-right: 1px solid rgba(0, 0, 0, 0.12);
		opacity: 0.8;
		background-color: gradient(linear, 0% 0%, 100% 0%, from(rgba(0, 0, 0, 0)), color-stop(0.5, rgba(0, 0, 0, 0.275)), to(rgba(0, 0, 0, 0.7)));
		transition: border-right 0.35s ease-out 0s;
	}
}


.drawer {
	z-index: 1;
	flow-children: right;
	horizontal-align: right;
	height: 100%;
	margin-top: $topnav-height;

	transform: translateX($drawer-width);
	transition: transform 0.35s ease-in-out 0s;

	&__content {
		width: $drawer-width;
		height: 100%;
		background-color: rgba(27, 27, 27, 0.7);
	}
	
	$this: &;
	&--expanded {
		transform: translateX(0);

		#{$this}__rightnav {
			background-color: rgba(32, 32, 32, 0.8);
		}

		#{$this}__left-shadow {
			border-right: 1px solid rgba(0, 0, 0, 0.2);
			background-color: gradient(linear, 0% 0%, 100% 0%, from(rgba(0, 0, 0, 0)), color-stop(0.5, rgba(0, 0, 0, 0.275)), to(rgba(0, 0, 0, 0.8)));
		}

		.rightnav__drawerbutton {
			transform: rotateX(180deg) rotateZ(180deg);
		}
	}
}

.home {
	&__newspanel {
		width: 840px;
		height: 500px;
	}

	&__modelpanel {
		width: 700px;
		height: 100%;
		margin-right: 200px;
		horizontal-align: right;
		vertical-align: middle;

		opacity: 1;
		blur: gaussian(0, 0, 0);
		transition-property: opacity, blur, pre-transform-scale2d, transform;
		transition-duration: 0.15s;
		transition-timing-function: ease-in-out;

		&--hidden {
			opacity: 0;
			transform: translateY(300px);
			blur: gaussian(10, 10, 4);
			pre-transform-scale2d: 0.8;
			transition-delay: 0.1s;
			transition-duration: 0.25s;
		}
	}

	&__bottombar {
		flow-children: right;
		horizontal-align: left;
		vertical-align: bottom;
	}

	&--hidden {
		visibility: collapse;
	}
}

.news {
	width: 100%;
	height: 100%;
	flow-children: down;
	margin: 24px;
	padding: 8px;
	background-color: rgba(0, 0, 0, 0.5);
	box-shadow: 0 0 4px 0 rgba(0, 0, 0, 0.3);

	&__latest {
		width: 100%;
		height: 258px; // This is a magic number because Panorama likes to scale stuff a bunch. Should be equal to the Actual Height Value of latestimage.
		flow-children: right;
	}

	&__latest-details {
		width: 40%;
		margin-right: 8px;
		flow-children: down;
	}

	&__latest-description {
		height: fill-parent-flow(1);
		padding-bottom: 0px;
		text-overflow: ellipsis;
		font-size: 14px;
		padding-right: 16px;
	}

	&__latest-image {
		width: 500px;
		height: width-percentage(56.25%);
	}

	&__latest-learnmore {
		height: 24px;
		width: 100%;
		vertical-align: bottom;
	}

	&__other {
		width: 100%;
		height: 100%;
		padding-top: 8px;
		padding-bottom: 16px;
		flow-children: right;
		overflow: scroll squish;
	}

	&__other-item {
		height: 100%;
		width: 274px; // Another alignment magic number, 16/9 * image's actual height
		margin-right: 8px;
	}

	&__other-image {
		transition: wash-color 0.1s linear 0s;

		&:hover {
			wash-color: rgb(222, 222, 222);
		}
	}
}

.bottombar {
	&__button {
		height: 48px;
		width: 48px;
		margin: 16px;

		& .RadioBox {
			visibility: collapse;
		}

		&-image {
			width: 100%;
			height: width-percentage(100%);
			vertical-align: middle;
			opacity: 0.75;
			transition: opacity 0.1s ease-in-out 0s;
			img-shadow: 0 0 2px 1 rgba(0, 0, 0, 1);
		}
	}
}

.mapselector__background {
	width: 1920px;
	height: 1080px;
	transition-property: opacity;
	transition-duration: $page-transition-duration;
	transition-timing-function: $page-transition-timing-func;
	opacity: 1;
	z-index: 1;

	&--hidden {
		opacity: 0;
	}
}

// These will get cleaned up in settings converion
.content-navbar {
	width: 100%;
	background-color: rgba(255, 255, 255, 0.05);
}

.content-navbar__title {
	padding: 10px 0px;
}

.content-navbar__tabs {
	flow-children: right;
}
